<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta name="generator" content="jemdoc, see http://jemdoc.jaboc.net/" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link rel="stylesheet" href="metro_style/metro-bootstrap.css" media="screen">
<link rel="stylesheet" href="private.css" media="screen">
<script src="metro_style/jquery.min.js"></script>
<script src="metro_style/jquery.widget.min.js"></script>
<script src="metro_style/metro.min.js"></script>
<title></title>
</head>
<body class="metro">
<header class="bg-light">
<div class="navigation-bar light">
<div class="navigation-bar-content container">
<nav class="horizontal-menu"><ul>
<li><a href="index.html">Main</a></li>
<li><a href="publications.html">Publications</a></li>
<li><a class="dropdown-toggle" href="#">Research</a>
<ul class="dropdown-menu inverse" data-role="dropdown">
<li><a href="bsbl.html">BSBL</a></li>
<li><a href="eit.html">EIT</a></li>
<li><a href="connectomics.html">Connectomics</a></li>
<li><a href="nircm.html">NIRCM</a></li>
<li><a href="phealth.html">phealth</a></li>
</ul></li>
<li><a class="dropdown-toggle" href="#">Hacks</a>
<ul class="dropdown-menu inverse" data-role="dropdown">
<li><a href="nudtpaper.html">nudtpaper</a></li>
<li><a href="udpip.html">udp/ip</a></li>
<li><a href="nrf51822.html">nrf51822</a></li>
<li><a href="kicad.html" class="current">kicad</a></li>
<li><a href="mathjax.html">mathjax</a></li>
</ul></li>
</ul></nav></div></div>
</header>
<div class="page"><div class="page-content margin20"><div class="page-container">
<h1>Kicad &ndash; from pmod boards to complex design</h1>

<p class=readable-text>This page is divided into two parts, <code><small>(one)</small></code> is a gallery of homebrew PCB boards and the corresponding <strong>.sch</strong> and <strong>.brd</strong> on github. <code><small>(the other)</small></code> is a on-going learning note of eagle(kicad) CAD software.</p>
<h2>Homebrew PCB Galleries</h2>
<h2>Digilent &ndash; the pmod resources</h2>

<p class=readable-text>The best tutorial goes to the official tutorial <strong>Getting started in Kicad</strong> and <a href="http://store.curiousinventor.com/guides/" target=&ldquo;blank&rdquo;>Courious Inventor</a>. It also has comprehensive video guide on how to soldering SMD and many others.</p>

<p class=readable-text>The most simple circuit board, as an add-on peripherals, might by the digilent pmod module. There are a lot example designs (schematics) on <a href="http://www.digilentinc.com/Products" target=&ldquo;blank&rdquo;>Digilent</a>. The <code><small>first step</small></code>, you could <em>copy board</em> a digilent pmod module, and feel the whole process of <strong>printing</strong> and <strong>soldering</strong> of one real PCB.</p>
<h2>Eagle vs Kicad &ndash; which one is better ?</h2>

<p class=readable-text>Sparkfun is a great website. We watched the videos and some on-line <a href="https://www.sparkfun.com/tutorials/" target=&ldquo;blank&rdquo;>tutorials</a>,</p>
<ol>
<li><p class="readable-text"><a href="https://www.sparkfun.com/tutorials/115" target=&ldquo;blank&rdquo;>Better PCBs in Eagle</a></p>
</li>
<li><p class="readable-text"><a href="https://www.sparkfun.com/tutorials/109" target=&ldquo;blank&rdquo;>Beginning Embedded Electronics - 9</a></p>
</li>
</ol>
<h3>eagle &ndash; schematic</h3>
<ol>
<li><p class="readable-text">Eagle has a verb-noun working flow, each time you select a <strong>verb</strong> (i.e., <code><small>move</small></code>, <code><small>add</small></code>, <code><small>copy</small></code>) and click the object to perform such operation. Group-ops is: <em>&gt; move &gt; group &gt; right click &gt; group move</em>. Commands can be abbrievated, <code><small>move</small></code> can be typed in the command line as <strong>mov</strong>, <code><small>copy</small></code> is <strong>cop</strong>, etc. Remember there is a <code><small>mirror</small></code> icon just beside the grid icon.</p>
</li>
<li><p class="readable-text">You may <code><small>move</small></code> or <code><small>copy</small></code> a component to connect to another pin. To visually connect a wire to a pin, or cross wires, you may add a <code><small>junction</small></code> to the crosspoint.</p>
</li>
<li><p class="readable-text">You should use <code><small>net</small></code> and <code><small>label</small></code> to denote a <strong>common</strong> connection from some ICs to another IC. Do not use <code><small>wire</small></code> and <code><small>label</small></code>. <code><small>Show</small></code> command is very useful in visualizing wires and ICs.</p>
</li>
<li><p class="readable-text">Try always <code><small>add frames</small></code> to your schematics and group align the frame w.r.t the center.</p>
</li>
</ol>
<h3>eagle &ndash; PCB layout</h3>

<p class=readable-text><em>usually, you may route with 10mil width and 8mil spacing, try to see how far you can go</em></p>
<ol>
<li><p class="readable-text">Make sure all <code><small>airwires</small></code> (thin lines that have not been routed yet) are routed.</p>
</li>
<li><p class="readable-text">While you in <code><small>move</small></code> command, press <code><small>Ctrl</small></code> key while clicking a component, the origin of the component will snap to the grid. You must decide whether you <code><small>route</small></code> in the top or bottom layer. In surface mount devices, we usually route on the <strong>top copper</strong> layer. After you placed all the components, you can use <code><small>ratsnest</small></code> to recalculate the airwires. If you want to use the <code><small>autorouter</small></code>, be sure to setup the grid to appropriate width, for example, <strong>7mil</strong> or <strong>14mil</strong>, and then press the <code><small>autorouter</small></code>. In the config-box, set the line width to the corresponding value.</p>
</li>
<li><p class="readable-text">Routing the <strong>GND</strong> plane. This is most important when you are using eagle. First, select the <code><small>polygon</small></code> tool, change line <strong>width</strong> to 10mil, and <strong>select on</strong> (the icon with a small circle on the up-left corner) to isolate parts and wires, the <strong>isolation width</strong> is 10mil, spacing (between the ground plane and the boarder of the PCB). Second, draw a rectangular around the board. Third, <code><small>name</small></code> the polygon <strong>GND</strong>. Final, press the <code><small>ratsnest</small></code> to generate the GND plane. <strong>Note</strong>, when you re-open the PCB board, the copper pour is not shown, so you need to press <code><small>ratsnest</small></code> to regenerate the GND plane. <em>Try, always pour GND plane with 10mil isolation.</em> You could modify the <strong>isolation</strong> and <strong>spacing</strong> of GND polygon by (i) <code><small>information</small></code> button.</p>
</li>
<li><p class="readable-text">Add important information, such as polarize of diode or capacitors, in the silk layer. (you may simply add <code><small>text</small></code> to <strong>tPlace</strong> layer). Make sure you add <code><small>text</small></code> to your functional pins, and place them on the <strong>tPlace</strong> layer, please use the <code><small>change</small></code> button to alter the size of text to <strong>0.05"</strong>. You can use the eye button to <code><small>show</small></code> the connection of pins and wires during this process. Add time stamp wires to the <strong>tBottom</strong> layer where there is no connection, it will automatically mirro the text and it's cool.</p>
</li>
<li><p class="readable-text">Use grid smart! Component Placement grid should be <code><small>50mil</small></code> and the routing should be the width (<code><small>10mil</small></code>) of the wire. The 0.05" grid rule applies to the component centers. Many component footprints are hard metric (for example 0.5mm spacing or 1x1.2mm pad sizes) and it is completely ok to layout pads and parts on the mm grid. However, when placing components I recommend the component centers stay ‘on grid’. This will help with routing and component alignment.</p>
</li>
<li><p class="readable-text">Hand route critical or sensitive parts of certain boards, Spend your time innovating! <strong>Remember</strong>, add (1) Date code at <strong>tBottom</strong>, (2) Silkscreen title and pin labels <code><small>text</small></code> <strong>tPlace</strong>, (3) Add standoff <code><small>hole</small></code> mounting <strong>drews</strong>, (4) Make sure all connections routed, (5) The direction of TX and RX being routed correctly, you may name <strong>RX-I</strong> and <strong>TX-O</strong>. (6) add debug vias, leds, and pullup and pulldown resistors.</p>
</li>
</ol>
<h3>Analog &amp; RF PCB design rules (by Ondo88)</h3>
<ol>
<li><p class="readable-text">Some PCB software offer “tear” connections (<code><small>use teardrop.ulp</small></code>) for pads and vias. This reduces mechanical stress around the via connection, avoiding possible rupture of the traces. Again, it’s also useful for RF applications, as it makes a better Z matching (it behaves as a tamper used in micro-wave circuits).</p>
</li>
<li><p class="readable-text">It’s a good practice to place holes around the boards, joining top and bottom ground layers. That makes the board more similar to <code><small>a Faraday cage</small></code>, reducing greatly effects from EMI (Electro-magnetic Interference). But to be truth, randomizing the distance between the holes makes a better isolation as no single frequency gets benefited form constructive interference.</p>
</li>
<li><p class="readable-text">Get to know what you’re building. Before getting serious about PCB design, you should learn what is everything you’re using on them. I’ve always said you can know if someone is a good PCB designer by asking him to give you <code><small>FR4</small></code> permitivity, solder fusion temperature and the like (without checking wikipedia ;D).</p>
</li>
<li><p class="readable-text">Another common mistake is not taking account of <code><small>thermal activity</small></code> on the board. Make sure your temperature sensitive components (like oscillators, and almost any analog circuit) are far from your heat generating circuits (regulators and the like). If your board fits in a box, be sure to have cooling paths that keep the things ok.</p>
</li>
<li><p class="readable-text">Some chips may have two VCC or GND pins one to each other. On SMD packages it’s tempting to just join them straight, avoid that if you’re using oven soldering (very likely on production). That will <code><small>unbalance</small></code> the thermal forces your chip may suffer, moving it from its original position, and possibly making it tombstone.</p>
</li>
<li><p class="readable-text">I’ve found very useful to place a couple of <code><small>squares on silkscreen</small></code>, with an E (Error) and a T (Tested) on the side of each one. That allows you to mark easily your boards with anything you may have at hand, from a pen to a screwdriver.</p>
</li>
<li><p class="readable-text">The last one is the more ethereal of the advises, <code><small>“follow your ground paths”</small></code>. Your signal propagates from your Vcc to your GND, mainly through the shortest path, if two signals share that ground path, they’ll interfere each other. Try to make that paths as short and trouble free as you can.</p>
</li>
</ol>
<h3>eagle &ndash; Gerber viewer</h3>

<p class=readable-text>Gerber Files are text files with coordinates that tell the PCB machines to go to location X,Y and do something (drill, expose, etch, print, etc). Because there are different layers to your PCB, you need to create different text files for the different layers. This is where the Eagle CAM program comes into play.</p>

<p class=readable-text>Here, we will use <code><small>sfe-gerb274x.cam</small></code> script by sparkfun (<strong>Top Section</strong> : Top, Pads, Vias, <code><small>Dimension(?)</small></code>. <strong>Bottom Section</strong> : Bottom, Pads, Vias). Anytime you transmit a PCB layout to a fab house, you need to pass them 7 files, and 7 files only:</p>
<ol>
<li><p class="readable-text">boardname.<strong>GTL</strong> Top Copper Layer</p>
</li>
<li><p class="readable-text">boardname.<strong>GBL</strong> Bottom Copper Layer</p>
</li>
<li><p class="readable-text">boardname.<strong>GTS</strong> Top Soldermask</p>
</li>
<li><p class="readable-text">boardname.<strong>GBS</strong> Bottom Soldermask</p>
</li>
<li><p class="readable-text">boardname.<strong>GTO</strong> Top Silkscreen</p>
</li>
<li><p class="readable-text">boardname.<strong>GBO</strong> Bottom Silkscreen</p>
</li>
<li><p class="readable-text">boardname.<strong>GKO</strong> Board Outline (<code><small>x</small></code>)</p>
</li>
<li><p class="readable-text">boardname.<strong>G2L</strong> only if you're uploading a four layer board</p>
</li>
<li><p class="readable-text">boardname.<strong>G3L</strong> only if you're uploading a four layer board</p>
</li>
<li><p class="readable-text">boardname.<strong>XLN</strong> Drills <strong>(2:4 Leading &ndash; remember this)</strong> (<code><small>.TXT</small></code>, 1st digit 2bit, 2nd digit 4bit)</p>
</li>
</ol>

<p class=readable-text>You will also see a <strong>GTP</strong> file extension. This is the Gerber Top Paste file. GTP includes all the paste for the pads of SMD and GTS includes both pads and vias. Last, but not finally, you can use <code><small>kicad</small></code> to visualize the gerber file.</p>
<h3>eagle &ndash; CAM process</h3>

<p class=readable-text>Finally, we come to the CAM process (for ShenZhen manufacture). We will need <strong>drillcfg.ulp</strong>, <strong>sfe-gerb274x.cam</strong> and <strong>excellon.cam</strong>.</p>
<ol>
<li><p class="readable-text">In PCB editor, type <code><small>run drillcfg</small></code> at the command window, select <strong>inch</strong> and press <strong>ok</strong>, you will get <strong>.drl</strong> file.</p>
</li>
<li><p class="readable-text">Process CAM button, and <code><small>load sfe-gerb274x.cam</small></code>, process job. You may also use <code><small>load excellon.cam</small></code> to generate <strong>.drd</strong> file.</p>
</li>
<li><p class="readable-text">Open CAM350, import all the files exclude .TXT (the drill file), we will importing the drill file in CAM350 by: <strong>import drill data</strong>, then select format as <strong>Leading 2:4</strong> to pad zeros.</p>
</li>
<li><p class="readable-text">Save all as <strong>.cam</strong> file.</p>
</li>
</ol>

<p class=readable-text>So let's sum up, we have <code><small>GTL, GTS, GTO</small></code> and <code><small>GBL, GBS, GBO</small></code> files, plus the drill file <code><small>.TXT, .drl, .drd</small></code>. And one file <code><small>.GTP</small></code> may also be included. If we are manufacturing 4-layer PCB, we will need <code><small>.G2L, .G3L</small></code> to denote the 3rd and 4th layer. All these files need to be visually checked in CAM350 and export as <code><small>.CAM</small></code> file.</p>
</div></div></div>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
